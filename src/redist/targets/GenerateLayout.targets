<Project>
  <PropertyGroup>
    <SdkOutputDirectory>$(ArtifactsDir)layout\$(Version)\</SdkOutputDirectory>
    <RedistLayoutPath>$(BaseOutputPath)$(Configuration)\dotnet-core-uninstall\</RedistLayoutPath>
    <DownloadsFolder>$(IntermediateOutputPath)downloads\</DownloadsFolder>
  </PropertyGroup>

  <Target Name="CleanLayoutPath">
    <!-- Remove everything from the publish directory so we don't have left over items from previous builds -->
    <RemoveDir Directories="$(RedistLayoutPath)" />
    <MakeDir Directories="$(RedistLayoutPath)" />
  </Target>

  <!-- TODO wul no check in add SignLayout back -->
  <Target Name="GenerateLayout"
          DependsOnTargets="CleanLayoutPath;
                            PublishDotnetCoreUninstallProject;
                            "
          BeforeTargets="AfterBuild">
  </Target>

  <Target Name="PublishDotnetCoreUninstallProject" AfterTargets="Build">
    <MSBuild
      BuildInParallel="False"
      Projects="$(RepoRoot)\src\dotnet-core-uninstall\dotnet-core-uninstall.csproj"
      Properties="NoBuild=true;PublishDir=$(RedistLayoutPath);PublishSingleFile=false"
      Targets="Publish">
    </MSBuild>
  </Target>
</Project>
